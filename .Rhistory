geom_hline(yintercept = max(totalstats$threepoints_percentage), color = "grey70", linetype = "dotted") +
geom_pointline(stroke = 0, linesize = 4, size = 6, linejoin = "mitre") +
# geom_point() +
scale_y_continuous(limits = c(0, 1), labels = scales::percent) +
scale_x_discrete(labels = c("Free Throws", "Two-pointers", "Three-pointers")) +
scale_color_identity() +
scale_alpha_manual(values = c(0.15, 1)) +
labs(
title = "Shooting percentages in the first round of the FIBA<br>World Cup 2019: Serbia and the others",
subtitle = "<span style='color:#e7051a'>**Serbia**</span> has a three-point field goal percentage of 53%, shooting<br>3-pointers better than 23 teams shoot 2-pointers. <span style='color:#1c2b7d'>**France**</span> is very<br>close with 52.6%. <span style='color:#e7051a'>**Serbia**</span> has also the best two-point field goal<br> percentage with 67.9% while <span style='color:#f7ca07'>**Australia**</span> has the second best with 62%",
caption = "Source: basketball-reference.com | Graphic: Georgios Karamanis"
) +
theme_minimal(base_family = "IBM Plex Sans", base_size = 12) +
theme(
legend.position = "none",
plot.margin = margin(20, 30, 20, 20),
plot.background = element_rect(fill = "grey90", color = NA),
axis.title = element_blank(),
axis.text = element_text(family = "IBM Plex Mono", size = 12),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
plot.title = element_markdown(size = 16, lineheight = 1.1, color = "grey20", family = "IBM Plex Sans Medium"),
plot.subtitle = element_markdown(size = 14, lineheight = 1.1, color = "grey40", margin = margin(0, 0, 20, 0)),
plot.caption = element_markdown(size = 8, color = "grey60", margin = margin(20, 0, 0, 0))
)
library(here)
library(tidyverse)
library(ggtext)
library(lemon)
ggplot(shot_stats, aes(x = type, y = percentage, group = team, color = team_color, alpha = (team_color != "grey60"))) +
geom_hline(yintercept = max(totalstats$threepoints_percentage), color = "grey70", linetype = "dotted") +
geom_pointline(stroke = 0, linesize = 4, size = 6, linejoin = "mitre") +
# geom_point() +
scale_y_continuous(limits = c(0, 1), labels = scales::percent) +
scale_x_discrete(labels = c("Free Throws", "Two-pointers", "Three-pointers")) +
scale_color_identity() +
scale_alpha_manual(values = c(0.15, 1)) +
labs(
title = "Shooting percentages in the first round of the FIBA<br>World Cup 2019: Serbia and the others",
subtitle = "<span style='color:#e7051a'>**Serbia**</span> has a three-point field goal percentage of 53%, shooting<br>3-pointers better than 23 teams shoot 2-pointers. <span style='color:#1c2b7d'>**France**</span> is very<br>close with 52.6%. <span style='color:#e7051a'>**Serbia**</span> has also the best two-point field goal<br> percentage with 67.9% while <span style='color:#f7ca07'>**Australia**</span> has the second best with 62%",
caption = "Source: basketball-reference.com | Graphic: Georgios Karamanis"
) +
theme_minimal(base_family = "IBM Plex Sans", base_size = 12) +
theme(
legend.position = "none",
plot.margin = margin(20, 30, 20, 20),
plot.background = element_rect(fill = "grey90", color = NA),
axis.title = element_blank(),
axis.text = element_text(family = "IBM Plex Mono", size = 12),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
plot.title = element_markdown(size = 16, lineheight = 1.1, color = "grey20", family = "IBM Plex Sans Medium"),
plot.subtitle = element_markdown(size = 14, lineheight = 1.1, color = "grey40", margin = margin(0, 0, 20, 0)),
plot.caption = element_markdown(size = 8, color = "grey60", margin = margin(20, 0, 0, 0))
)
objects()
rm(list = ls(all.names = TRUE))
source("R/points-game.R")
results %>% gather(homeaway, team, c(home, team))
results
results %>% gather(homeaway, team, c(home, visitor))
results %>% gather(homeaway, team, c(home, visitor)) %>% gather(homeawaypoints, team, c(pts_home, pts_visitor))
results %>% gather(homeaway, team, c(home, visitor)) %>% gather(homeawaypoints, teampoints, c(pts_home, pts_visitor))
results %>% gather(homeaway, team, c(home, visitor)) %>% gather(homeawaypoints, points, c(pts_home, pts_visitor))
source("R/points-game.R")
source("R/points-game.R")
source("R/points-game.R")
source("R/points-game.R")
source("R/points-game.R")
source("R/points-game.R")
source("R/points-game.R")
source("R/points-game.R")
results
results
source("R/points-game.R")
source("R/points-game.R")
source("R/points-game.R")
source("R/points-game.R")
source("R/points-game.R")
source("R/points-game.R")
long_results
source("R/points-game.R")
q()
source("R/points-game.R")
source("R/points-game.R")
source("R/points-game.R")
source("R/teampoints-game.R")
source("R/teampoints-game.R")
source("R/teampoints-game.R")
q()
source('~/Documents/Projects/R/FIBA-BWC19/R/scrape-playerstats.R', echo=TRUE)
library(tidyverse)
library(rvest)
library(janitor)
library(here)
url <- "https://en.m.wikipedia.org/wiki/2019_FIBA_Basketball_World_Cup_squads"
# read in tables
webpage <- read_html(url)
tbls <- html_nodes(webpage, "table")
# read in countries list
countries <- webpage %>%
html_nodes("h3 .mw-headline") %>%
xml_attr("id") %>%
str_replace(., "_", " ")
# read in rosters
teams = list()
for (i in  seq(2, 64, 2)) {
team <- html_table(tbls[[i]], fill = TRUE)
team$country <- countries[i/2]
teams[[i]] <- team
}
teams <- do.call(rbind, teams)
# clean
teams_clean <- teams %>%
clean_names() %>%
rename(
position = pos,
number = no,
date_of_birth = age_date_of_birth,
club_country = ctr
) %>%
# extract dob, height, captain and change types
mutate(
date_of_birth = as.Date(str_extract(date_of_birth, "\\d{4}-\\d{2}-\\d{2}")),
height = as.numeric(str_extract(height, "\\d{1}\\.\\d{1,2}")),
captain = case_when(
str_detect(name, "\\(C\\)") ~ TRUE,
TRUE ~ NA),
name = str_remove(name, ".\\(C\\)"),
number = as.numeric(number)
) %>%
# reorder columns
select(country, 1:3, captain, everything())
View(teams_clean)
View(team)
View(tbls)
countries
flags <-
webpage
flags <-
webpage %>% html_node()
flags <-
webpage %>% html_nodes()
flags <-
webpage %>% html_nodes(.sortable)
flags <-
webpage %>% html_nodes(.toccolors .sortable)
flags <-
webpage %>% html_nodes(.toccolours .sortable)
flags <-
webpage %>% html_nodes(".toccolours .sortable")
flags <-
webpage %>% html_nodes(".toccolours .sortable")
webpage %>% html_nodes(".toccolours .sortable")
webpage %>% html_nodes(".toccolours .sortable .flagicon")
webpage %>% html_nodes(".toccolours .sortable .flagicon") %>% xml_attr("title")
webpage %>% html_nodes(".toccolours .sortable .flagicon .a") %>% xml_attr("title")
webpage %>% html_nodes(".toccolours .sortable .flagicon .a")
webpage %>% html_nodes(".toccolours .sortable .flagicon")
webpage %>% html_nodes(".toccolours .sortable .flagicon") %>% xml_attr("text")
webpage %>% html_nodes(".toccolours .sortable .flagicon") %>% xml_attr()
webpage %>% html_nodes(".toccolours .sortable .flagicon")
webpage %>% html_nodes(".toccolours .sortable .flagicon")  %>% [1]
webpage %>% html_nodes(".toccolours .sortable .flagicon")  %>% [[1]]
webpage %>% html_nodes(".toccolours .sortable .flagicon")  %>% .[[1]]
webpage %>% html_nodes(".toccolours .sortable .flagicon a")
webpage %>% html_nodes(".toccolours .sortable .flagicon a title")
webpage %>% html_nodes(".toccolours .sortable .flagicon a") %>% html_attr("text")
webpage %>% html_nodes(".toccolours .sortable .flagicon a") %>% html_attr("title")
tbls
tbls %>% html_nodes(".toccolours .sortable .flagicon a") %>% html_attr("title")
tbls[[1]] %>% html_nodes(".toccolours .sortable .flagicon a") %>% html_attr("title")
tbls[[1]] %>% html_nodes(".sortable .flagicon a") %>% html_attr("title")
tbls[[2]] %>% html_nodes(".sortable .flagicon a") %>% html_attr("title")
tbls[[3]] %>% html_nodes(".sortable .flagicon a") %>% html_attr("title")
tbls[[4]] %>% html_nodes(".sortable .flagicon a") %>% html_attr("title")
tbls[[5]] %>% html_nodes(".sortable .flagicon a") %>% html_attr("title")
View(team)
View(teams_clean)
View(teams)
team$Ctr. <- tbls[[i]]  %>% html_nodes(".sortable .flagicon a") %>% html_attr("title")
team$Ctr. <- tbls[[i+1]]  %>% html_nodes(".sortable .flagicon a") %>% html_attr("title")
team$Ctr <- tbls[[i]]  %>% html_nodes(".sortable .flagicon a") %>% html_attr("title")
for (i in  seq(2, 64, 2)) {
team <- html_table(tbls[[i]], fill = TRUE)
team$country <- countries[i/2]
team$Ctr <- tbls[[i]]  %>% html_nodes(".sortable .flagicon a") %>% html_attr("title")
teams[[i]] <- team
}
team
team$Ctr.
team$Ctr. <- tbls[[i]]  %>% html_nodes(".sortable .flagicon a") %>% html_attr("title")
tbls %>% html_nodes(".sortable .flagicon a") %>% html_attr("title")
tbls
# read in club countries
ctr <- tbls %>% html_nodes(".sortable .flagicon a") %>% html_attr("title")
ctr
source('~/Documents/Projects/R/FIBA-BWC19/R/scrape-playerstats.R', echo=TRUE)
source('~/Documents/Projects/R/FIBA-BWC19/R/scrape.R', echo=TRUE)
View(teams)
View(ctr)
380/12
# read in club countries
ctr <- tbls %>%
html_nodes(".sortable .flagicon a",  fill = TRUE) %>%
html_attr("title")
# read in club countries
ctr <- tbls %>%
html_nodes(".sortable .flagicon a") %>%
html_attr("title",  fill = TRUE)
tbls[[2]]
tbls[[1]]
tbls[[2]]
tbls[[2]] %>% html_nodes(".sortable .flagicon a")
tbls[[2]] %>% html_nodes(".sortable .flagicon")
tbls[[2]] %>% html_nodes(".sortable")
html_table(tbls[[2]], fill = TRUE)
html_table(tbls[[4]], fill = TRUE)
html_table(tbls[[4]], fill = TRUE) %>% html_nodes()
tbls[[2]]
tbls[[2]] %>% html_nodes(".mwheadline")
tbls[[2]] %>% html_nodes("in-block")
tbls[[2]] %>% html_nodes(".in-block")
tbls[[2]] %>% html_nodes("â‚¬in-block")
tbls[[2]] %>% html_nodes("#in-block")
tbls[[2]] %>% html_nodes(".tbody")
tbls[[2]] %>% xml_attr(".tbody")
tbls[[2]] %>% xml_attr("title")
tbls[[2]] %>% .[2]
tbls[[2]] %>% .[1:2]
tbls[[2]]
tbls[[2]] %>% html_attrs(".ht")
tbls[[2]] %>% html_attrs("ht")
tbls[[2]] %>% html_attrs("tr")
tbls[[2]] %>% html_attrs(".tr")
tbls[[2]]
tbls
tbls[[2]] %>%
html_nodes(".sortable .flagicon a")
tbls[[2]] %>%
html_nodes(".sortable")
tbls[[2]]
tbls[[2]] %>%
html_node(".sortable")
tbls[[2]] %>%
html_node(".sortable .flagicon a")
tbls[[2]] %>%
html_node(".sortable .flagicon a") %>% html_attr("title")
tbls[[2]] %>%
html_node(".sortable .flagicon a")
tbls[[2]] %>%
html_node(".sortable .flagicon")
tbls[[2]] %>%
html_node(".sortable")
tbls
tbls[[2]]
tbls[[2]] %>% html_node(".sortable")
tbls[[2]] %>% html_nodes(".sortable")
tbls[[2]] %>% xml_attr(".sortable")
tbls[[2]] %>% xml_attr("tbody")
tbls[[2]] %>% xml_attrs("tbody")
tbls[[2]] %>% xml_attrs("tbody tr")
tbls[[2]] %>% xml_attrs("tbody tr th")
tbls[[2]] %>% xml_attrs("th")
tbls[[2]] %>% xml_attrs()
tbls[[2]] %>% xml_attrs("sortable")
tbls[[2]] %>% xml_attr("sortable")
tbls[[2]] %>% xml_attr(".sortable")
tbls[[2]] %>% xml_attrs()
View(tbls)
tbls[[2]] %>% html_attrs(tbody)
tbls[[2]] %>% html_attrs("tbody")
tbls[[2]] %>% html_attrs("table.tbody")
tbls[[2]] %>% html_attrs("th")
tbls[[2]] %>% html_attrs("tr")
tbls[[2]] %>% html_attrs("tbody tr")
tbls[[2]] %>% html_nodes("tbody tr")
tbls[[2]] %>% html_nodes("tbody")
tbls[[2]] %>% html_nodes("tbody tr td")
tbls[[2]] %>% html_nodes("tbody tr td td")
tbls[[2]] %>% html_nodes("tbody tr td a")
tbls[[4]] %>% html_nodes("tbody tr td a")
tbls[[4]] %>% html_nodes("tbody tr tr td a")
tbls[[4]] %>% html_nodes("tbody tr tr")
tbls[[4]] %>% html_nodes("tbody tr td")
tbls[[4]] %>% html_nodes("tbody td")
tbls[[4]] %>% html_nodes("tbody td a")
tbls[[4]] %>% html_nodes("tbody tr th")
tbls[[4]] %>% html_nodes("tbody tr th abbr")
tbls[[4]] %>% html_nodes("tbody tr")
tbls[[4]] %>% html_nodes("tbody tr :last-child")
tbls[[4]] %>% html_nodes("tbody tr td :last-child")
tbls[[4]] %>% html_nodes("tbody tr td :last-child") %>% xml_attr("title")
tbls[[4]] %>% html_nodes("tbody td :last-child") %>% xml_attr("title")
tbls[[4]] %>% html_nodes("tbody:last-child") %>% xml_attr("title")
tbls[[4]] %>% html_nodes("tbody :last-child") %>% xml_attr("title")
tbls[[4]] %>% html_nodes("tbody :last-child .flagicon") %>% xml_attr("title")
tbls[[4]] %>% html_nodes("tbody :last-child .flagicon")
tbls[[4]] %>% html_nodes("tbody :last-child .flagicon") %>% xml_attr("title")
tbls[[4]] %>% html_nodes("tbody :last-child .flagicon") %>% xml_attr("a")
tbls[[4]] %>% html_nodes("tbody :last-child .flagicon a")
tbls[[4]] %>% html_nodes("tbody :last-child .flagicon title")
tbls[[4]] %>% html_nodes("tbody :last-child .flagicon")
tbls[[4]] %>% html_nodes("tbody :last-child flagicon")
tbls[[4]] %>% html_nodes("tbody :last-child .flagicon")
tbls[[4]] %>% html_nodes("tbody :last-child .flagicon a")
tbls[[4]] %>% html_nodes("tbody :last-child .flagicon a") %>% xml_attr("title")
# read in rosters
teams = list()
for (i in  seq(2, 64, 2)) {
team <- html_table(tbls[[i]], fill = TRUE)
team$country <- countries[i/2]
team$Ctr. <- tbls[[i]] %>%
html_nodes("tbody :last-child .flagicon a") %>%
xml_attr("title")
teams[[i]] <- team
}
tbls[[4]] %>% html_nodes("tbody :last-child .flagicon a") %>% xml_attr("title")
tbls[[20]] %>% html_nodes("tbody :last-child .flagicon a") %>% xml_attr("title")
tbls[[22]] %>% html_nodes("tbody :last-child .flagicon a") %>% xml_attr("title")
tbls[[18]] %>% html_nodes("tbody :last-child .flagicon a") %>% xml_attr("title")
tbls[[18]] %>% html_nodes("tbody :last-child .flagicon a") %>% xml_attr("title") %>% as.tibble()
tbls[[18]] %>% html_nodes("tbody :last-child .flagicon a") %>% xml_attr("title") %>% as_tibble()
tbls[[18]] %>% html_nodes("tbody :last-child .flagicon a") %>% xml_attr("title")
tbls[[18]] %>% html_nodes("tbody :last-child .flagicon a") %>% xml_attr("title") %>% [1]
tbls[[18]] %>% html_nodes("tbody :last-child .flagicon a") %>% xml_attr("title") %>% [2]
tbls[[18]] %>% html_nodes("tbody :last-child .flagicon a") %>% xml_attr("title") %>% .[2]
tbls[[18]] %>% html_nodes("tbody :last-child .flagicon a") %>% xml_attr("title") %>% .[12]
tbls[[18]] %>% html_nodes("tbody :last-child .flagicon a") %>% xml_attr("title") %>% .[11]
tbls[[18]] %>% html_nodes("tbody :last-child .flagicon a") %>% xml_attr("title") %>% list()
ctr <- vector(mode = "list", length = 12)
ctr
ctr <- tbls[[18]] %>% html_nodes("tbody :last-child .flagicon a") %>% xml_attr("title")
ctr
ctr <- vector(mode = "list", length = 12)
ctr$fl <- tbls[[18]] %>% html_nodes("tbody :last-child .flagicon a") %>% xml_attr("title")
ctr
View(ctr)
rm(ctr)
ctr$list <- vector(mode = "list", length = 12)
ctr <- vector(mode = "list", length = 12)
ctr <- tbls[[18]] %>% html_nodes("tbody :last-child .flagicon a") %>% xml_attr("title")
View(ctr)
ctr <- data.frame(list = ctr)
ctr
imdb <- read_html("http://www.imdb.com/search/title?genres=horror&genres=mystery&sort=moviemeter,asc&view=advanced")
title <- html_nodes(imdb, '.lister-item-header a')
title <- html_text(title)
metascore <- html_node(html_nodes(imdb, '.lister-item-content'), '.ratings-metascore span')
metascore <- html_text(metascore)
View(title)
View(metascore)
metascore <- html_node(html_nodes(imdb, '.lister-item-content'), '.ratings-metascore span') %>% html_text(metascore)
View(metascore)
tbls[[18]] %>% html_nodes("tbody :last-child .flagicon a") %>% xml_attr("title")
tbls[[18]] %>% html_node(html_nodes("tbody :last-child .flagicon a")) %>% xml_attr("title")
tbls[[18]] %>% html_node(html_nodes("tbody :last-child .flagicon a")) %>% xml_attrs("title")
tbls[[18]] %>% html_nodes("tbody :last-child .flagicon a") %>% xml_attr("title")
tbls[[18]] %>% html_nodes("tbody :last-child .flagicon a") %>% html_text("title")
tbls[[18]] %>% html_nodes("tbody :last-child .flagicon a") %>% html_text(title)
tbls[[18]] %>% html_node(html_nodes("tbody :last-child .flagicon a")) %>% xml_attr("title")
tbls[[18]] %>% html_nodes("tbody :last-child .flagicon a") %>% xml_attr("title")
tbls[[18]] %>% html_node(html_nodes("tbody :last-child .flagicon")) %>% xml_attr("title")
tbls[[18]] %>% html_node(html_nodes("tbody :last-child .flagicon"), "a") %>% xml_attr("title")
tbls[[18]] %>% html_node(html_nodes("tbody :last-child .flagicon"), "a")
tbls[[18]] %>% html_node(html_nodes("tbody :last-child .flagicon"), a)
tbls[[18]] %>% html_node(html_nodes("tbody :last-child .flagicon"))
tbls[[18]] %>% html_node(html_nodes("tbody :last-child"))
tbls[[18]] %>% html_node(html_nodes("tbody"))
tbls[[18]] %>% html_node(html_nodes("tbody"), ":last-child .flagicon a")
tbls[[18]] %>% html_node(html_nodes("tbody :last-child .flagicon"), "a") %>% xml_attr("title")
tbls[[18]] %>% html_node(html_nodes("tbody :last-child .flagicon a")) %>% xml_attrs("title")
ctr <- tbls[[18]] %>% html_nodes("tbody :last-child .flagicon a") %>% xml_attr("title")
tbls[[18]] %>% html_nodes("tbody :last-child .flagicon a") %>% xml_attr("title")
tbls[[18]] %>% html_nodes("tbody :last-child .flagicon a") %>% xml_attr("a title")
tbls[[18]] %>% html_nodes("tbody :last-child .flagicon") %>% xml_attr("a title")
tbls[[18]] %>% html_nodes("tbody :last-child .flagicon")
tbls[[18]] %>% html_nodes("tbody :last-child")
tbls[[18]] %>% html_nodes("tbody")
tbls[[18]] %>% html_nodes("tbody :last-child")
tbls[[18]] %>% html_nodes("tbody") %>% html_nodes(":last-child .flagicon a")
tbls[[18]] %>% html_node(html_nodes("tbody")) %>% html_nodes(":last-child .flagicon a")
tbls[[18]] %>% html_nodes("tbody") %>% html_node(html_nodes(":last-child .flagicon a"))
tbls[[18]] %>% html_nodes("tbody")
tbls[[18]] %>% html_nodes("tbody tr")
tbls[[18]] %>% html_node(html_nodes("tbody tr")) %>% html_nodes(":last-child .flagicon a")
tbls[[18]] %>% html_nodes("tbody tr") %>% html_nodes(":last-child .flagicon a")
tbls[[18]] %>% html_nodes("tbody tr :last-child .flagicon a")
tbls[[18]] %>% html_nodes("tbody :last-child .flagicon a")
tbls[[18]] %>% html_nodes("tbody tr")
tbls[[18]] %>% html_table()
tbls[[18]] %>% html_nodes("tbody tr :last-child .flagicon a")
tbls[[18]] %>% html_nodes("tbody :last-child .flagicon a") %>% xml_attr("title")
tbls[[18]] %>% html_nodes("tbody :last-child .flagicon")
tbls[[18]] %>% html_nodes("tbody :last-child")
tbls[[18]] %>% html_nodes("tbody :last-child .flagicon") %>% html_children()
tbls[[18]] %>% html_nodes("tbody")
tbls[[18]] %>% html_nodes("tbody :last-child")
tbls[[18]] %>% html_nodes("tbody nth-last-child(2)")
tbls[[18]] %>% html_nodes("tbody :nth-last-child(2)")
tbls[[18]] %>% html_nodes("tbody :nth-last-child(1)")
tbls[[18]] %>% html_nodes("tbody nth-last-child(2)")
tbls[[18]] %>% html_nodes("tbody :nth-last-child(1)")
tbls[[18]] %>% html_nodes("tbody :nth-last-child(1) .flagicon")
tbls[[18]] %>% html_nodes("tbody tr :nth-last-child(1) .flagicon")
tbls[[18]] %>% html_nodes("tbody :nth-last-child(1) .flagicon")
tbls[[18]] %>% html_nodes("tbody :nth-last-child(2) .flagicon")
tbls[[18]] %>% html_nodes("tbody :nth-last-child(3) .flagicon")
tbls[[18]] %>% html_nodes("tbody :nth-last-child(2) .flagicon")
tbls[[18]] %>% html_nodes("tbody :nth-last-child(2) .flagicon")
tbls[[18]] %>% html_nodes("tbody :nth-last-child(1) .flagicon")
tbls[[18]] %>% html_nodes("tbody tr :nth-last-child(1) .flagicon")
tbls[[18]] %>% html_nodes("tbody tr :nth-last-child(1) .flagicon")
tbls[[18]] %>% html_nodes("tbody tr :nth-last-child(2) .flagicon")
tbls[[18]] %>% html_nodes("tbody tr :nth-last-child(2)")
tbls[[18]] %>% html_nodes("tbody tr :nth-last-child(2) alt")
tbls[[18]] %>% html_nodes("tbody tr :nth-last-child(2)")
tbls[[18]] %>% html_nodes("tbody tr :nth-last-child(2) title")
tbls[[18]] %>% html_nodes("tbody tr :nth-last-child(2)") %>% xml_attr(title)
tbls[[18]] %>% html_nodes("tbody tr :nth-last-child(2)") %>% xml_attr("title")
tbls[[18]] %>% html_nodes("tbody :nth-last-child(2)") %>% xml_attr("title")
tbls[[18]] %>% html_nodes("tbody :nth-last-child(2) tr") %>% xml_attr("title")
tbls[[18]] %>% html_nodes("tbody :nth-last-child(2) tr")
tbls[[18]] %>% html_nodes("tbody :nth-last-child(2)")
tbls[[18]] %>% html_nodes("tbody tr td tbody :nth-last-child(2)")
tbls[[18]] %>% html_nodes("tbody tr td :nth-last-child(2)")
tbls[[18]] %>% html_nodes("tbody tr td :nth-last-child(2)")
tbls[[18]] %>% html_nodes("tbody tr td :nth-last-child(2)") %>% xml_attr("title")
tbls[[18]] %>% html_nodes("tbody tr td :nth-last-child(2)")
tbls[[18]] %>% html_nodes("tbody tr td tbody :nth-last-child(2)")
tbls[[18]] %>% html_nodes("tbody tr td tbody tr :nth-last-child(2)")
tbls[[18]] %>% html_nodes("tbody tr td tbody td tr :nth-last-child(2)")
tbls[[18]] %>% html_nodes("tbody tr td tbody tr :nth-last-child(2)")
tbls[[18]] %>% html_nodes("tbody tr td table tbody tr :nth-last-child(2)")
tbls[[i]] %>%
html_nodes("tbody :last-child .flagicon a") %>%
xml_attr("title")
team$country <- countries[i/2]
for (i in  seq(2, 64, 2)) {
team <- html_table(tbls[[i]], fill = TRUE)
team$country <- countries[i/2]
team$Ctr. <- tbls[[i]] %>%
html_nodes("tbody :last-child .flagicon a") %>%
xml_attr("title")
teams[[i]] <- team
}
html_nodes(imdb, '.lister-item-header a')
html_node(html_nodes(imdb, '.lister-item-content'), '.ratings-metascore span')
(html_nodes(imdb, '.lister-item-content')
)
tbls[[i]] %>%
html_nodes("tbody)
""
tbls[[i]] %>% html_nodes("tbody")
tbls[[i]] %>% html_nodes("tbody tr")
tbls[[i]] %>% html_node(html_nodes("tbody tr"))
tbls[[i]] %>% html_node(html_nodes("tbody tr"), "td")
tbls[[i]] %>% html_node(html_nodes("tbody tr"), td)
tbls[[i]] %>% html_node(html_nodes("tbody tr"), )
tbls[[i]] %>% html_node(html_nodes("tbody tr"), .flagicon)
tbls[[i]] %>% html_node(html_nodes("tbody tr"), ".flagicon")
html_nodes(imdb, '.lister-item-content')
tbls[[i]] %>% html_node(html_nodes("tbody tr"), ".flagicon")
tbls[[i]] %>%
html_nodes("tbody tr")
tbls[[20]] %>% html_node(html_nodes("tbody tr"), ".flagicon")
tbls[[20]] %>% html_node(html_nodes("tbody tr"), ".flagicon")
html_node(html_nodes(tbls[[20]] "tbody tr"), ".flagicon")
html_node(html_nodes(tbls[[20]], "tbody tr"), ".flagicon")
html_node(html_nodes(tbls[[20]], "tbody tr"), ".flagicon") %>% xml_attr("a")
html_node(html_nodes(tbls[[20]], "tbody tr"), ".flagicon") %>% xml_attr("title")
html_node(html_nodes(tbls[[20]], "tbody tr"), ".flagicon") %>% html_text(title)
html_node(html_nodes(tbls[[20]], "tbody tr"), ".flagicon")
html_node(html_nodes(tbls[[20]], "tbody tr"), ".flagicon a") %>% xml_attr("title")
html_node(html_nodes(tbls[[18]], "tbody tr"), ".flagicon a") %>% xml_attr("title")
html_node(html_nodes(tbls[[18]], "tbody tr tr"), ".flagicon a") %>% xml_attr("title")
html_node(html_nodes(tbls[[18]], "tbody tr"), ".flagicon a") %>% xml_attr("title")
html_node(html_nodes(tbls[[18]], "tbody:not(:first-child)"), ".flagicon a") %>% xml_attr("title")
html_node(html_nodes(tbls[[18]], "tbody :not(:first-child)"), ".flagicon a") %>% xml_attr("title")
html_node(html_nodes(tbls[[18]], "tbody tr :not(:first-child)"), ".flagicon a") %>% xml_attr("title")
html_node(html_nodes(tbls[[18]], "tbody tr:not(:first-child)"), ".flagicon a") %>% xml_attr("title")
# read in rosters
teams = list()
for (i in  seq(2, 64, 2)) {
team <- html_table(tbls[[i]], fill = TRUE)
team$country <- countries[i/2]
team$Ctr. <- html_node(html_nodes(tbls[[i]], "tbody tr:not(:first-child)"), ".flagicon a") %>% xml_attr("title")
teams[[i]] <- team
}
teams <- do.call(rbind, teams)
# clean
teams_clean <- teams %>%
clean_names() %>%
rename(
position = pos,
number = no,
date_of_birth = age_date_of_birth,
club_country = ctr
) %>%
# extract dob, height, captain and change types
mutate(
date_of_birth = as.Date(str_extract(date_of_birth, "\\d{4}-\\d{2}-\\d{2}")),
height = as.numeric(str_extract(height, "\\d{1}\\.\\d{1,2}")),
captain = case_when(
str_detect(name, "\\(C\\)") ~ TRUE,
TRUE ~ NA),
name = str_remove(name, ".\\(C\\)"),
number = as.numeric(number)
) %>%
# reorder columns
select(country, 1:3, captain, everything())
View(teams_clean)
